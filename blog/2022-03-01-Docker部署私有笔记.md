---
title: Docker部署私有笔记
date: 2022-03-01 19:49:23
tags: [docker]
authors : niko
---
Docker部署私有笔记，欢迎使用！

为知笔记是一款老牌笔记应用了，支持markdown等多功能，本人也用了好几年了。云同步功能付费，每年60，作为白嫖党还是有点点心疼的，毕竟不是买断制收费。

好在最近推出了docker私有化部署的功能，可以支持5个用户，当然这个是可以破解的，已实现vip功能（会放在安装教程后）

## 部署docker镜像

先贴上官方教程：https://www.wiz.cn/zh-cn/docker

```
cd ~
mkdir wizdata // 这是数据目录，可迁移可备份
// 创建docker
// linux版
docker run --name wiz --restart=always -it -d -v  ~/wizdata:/wiz/storage -v  /etc/localtime:/etc/localtime -p 8848:80 -p 9269:9269/udp  wiznote/wizserver
// mac版
docker run --name wiz --restart=always -it -d -v  ~/wizdata:/wiz/storage -e TZ=`ls -la /etc/localtime | cut -d/ -f8-9` -p 8848:80 -p 9269:9269/udp  wiznote/wizserver
```

这样就已经部署好了，端口是8848，可自行更改（本人没有群晖设备，但大致应该都和Linux版差不太多，可自行探索）

如果想要搜索文本功能，可以加上“-e SEARCH=true”，不过内存要求4g左右才够用！

## 使用私有为知笔记

第一次运行镜像，因为需要下载docker镜像，并且初始化数据，速度要慢一些。请耐心等待。（根据网络状况，可能需要10分钟或者更长时间。）在下载完成后，第一次启动镜像大概需要2-3分钟时间。

然后打开浏览器，在地址栏里面输入：http://localhost:8090，如果服务正常，则会出现下面的界面

![](https://gh.136699.xyz/https://github.com/weixiabing/wordpress/blob/main/pic/20220301195746.png)

默认管理员账号：admin@wiz.cn，密码：123456。请在部署完成后，使用这个账号，登录网页版，然后修改管理员密码。其他用户，请自行注册。免费版本可以注册5个用户（不包含管理员账号）

## 破解vip功能

PS：破解方法非原创哈～之前在看雪上翻到的大佬教程，搜索了下没找到，有找到的可以提供下链接，下面开始教学

```
// 进入容器
docker exec -it wiz bash
// 编辑核心文件
vi /wiz/app/wizserver/node_modules/node-rsa/src/NodeRSA.js
```

输入“/NodeRSA.prototype.decryptPublic”回车，找到破解位置，替换NodeRSA.prototype.decryptPublic = function (buffer, encoding)方法

```
/**
* Decrypting data method with public key
*
* Parameters same as `decrypt` method
*/
NodeRSA.prototype.decryptPublic = function (buffer, encoding) {
    // return this.$decryptKey(true, buffer, encoding);
    var data = this.$decryptKey(true, buffer, encoding);
    try {
        var v = JSON.parse(data);
        if (v.count == 5) {
            v.count = 999;
            v.type = 'license_vip';
            v.oem = '红叶';
            data = Buffer.from(JSON.stringify(v));
        }
    } catch (e) {}
    return data;
};
```

其中v.count是授权账号数、v.oem是显示授权账号名，均可自行修改。

重启容器docker restart wiz后，进入管理员账号，打开系统管理，即可显示如下图

![](https://gh.136699.xyz/https://github.com/weixiabing/wordpress/blob/main/pic/20220301195828.png)

## 破解文件映射镜像

文件已上传github：[下载链接](https://github.com/yao177/sillygirl-plugin/blob/main/NodeRSA.js)

下载到~/wizdata/crack文件夹中

```
// linux版
docker run --name wiz --restart=always -it -d -v  ~/wizdata:/wiz/storage -v  /etc/localtime:/etc/localtime -p 8848:80 -p 9269:9269/udp -v ~/wizdata/crack/NodeRSA.js:/wiz/app/wizserver/node_modules/node-rsa/src/NodeRSA.js:ro  wiznote/wizserver
```
